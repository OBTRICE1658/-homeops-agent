<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
<title>HomeOps</title>

  <link rel="stylesheet" href="style.css" />
    <!-- ‚úÖ Add Tippy.js tooltip support -->
  <link rel="stylesheet" href="https://unpkg.com/tippy.js@6/dist/tippy.css" />
  <script src="https://unpkg.com/@popperjs/core@2"></script>
  <script src="https://unpkg.com/tippy.js@6"></script>
  <!-- API Configuration -->
  <script src="config.js"></script>
  <style>
    .reframe-list {
      display: flex;
      flex-direction: column;
      gap: 1rem;
      padding-top: 0.5rem;
    }

    .reframe {
      background: #f9f9fb;
      border: 1px solid #ddd;
      border-radius: 12px;
      padding: 1rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    }

    .reframe h4 {
      margin: 0 0 0.25rem;
      font-size: 1.1rem;
      color: #333;
    }

    .reframe p {
      margin: 0.25rem 0;
      font-size: 0.95rem;
      line-height: 1.4;
      color: #555;
    }

    .reframe p em {
      color: #777;
    }

    .user-menu {
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .user-email {
      font-size: 0.9rem;
      color: #666;
    }

    .logout-btn {
      background: #ff4757;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      transition: background-color 0.3s;
    }

    .logout-btn:hover {
      background: #ff3742;
    }
  </style>
</head>
<body>
  <div class="app-container">

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <div class="logo">
          <img src="img/logo.svg" alt="HomeOps Logo" class="sidebar-logo">
        </div>
      </div>
      <nav class="nav">
        <button class="nav-item active" data-view="home" title="My Ops Center"><i data-lucide="home"></i></button>
        <button class="nav-item" data-view="chat" title="Ask HomeOps"><i data-lucide="message-square"></i></button>
        <button class="nav-item" data-view="dashboard" title="The House View"><i data-lucide="bar-chart-3"></i></button>
        <button class="nav-item" data-view="calendar" title="Calendar View"><i data-lucide="calendar-days"></i></button>
      </nav>
    </aside>

    <main class="main-content">

  <!-- Top Bar with logo + brand and hamburger -->
  <header class="top-bar">
    <div class="top-bar-left">
      <button class="hamburger" id="hamburgerBtn" aria-label="Open menu" aria-controls="sidebar" aria-expanded="false">
        <span class="hamburger-bar"></span>
        <span class="hamburger-bar"></span>
        <span class="hamburger-bar"></span>
      </button>
      <a href="#" onclick="activateView('home'); return false;" class="top-bar-logo-link">
        <img src="img/logo.svg" alt="HomeOps Logo" class="top-bar-logo">
        <span class="brand-name">HomeOps</span>
      </a>
    </div>
    <div class="user-menu">
      <span class="user-email" id="userEmail"></span>
      <button class="logout-btn" id="logoutBtn">Logout</button>
    </div>
  </header>

  <!-- Home View -->
  <section id="home-view" class="view">
    <div class="home-grid">
      <!-- Email Decoder Engine Card -->
      <div id="email-decoder-engine-card" class="home-module modern-placeholder">
        <div class="module-header">
          <h2 style="font-size:2rem;display:flex;align-items:center;gap:0.5rem;">
            <i data-lucide="brain" style="width:2.2rem;height:2.2rem;"></i> Email Decoder Engine
          </h2>
          <p style="font-size:1.1rem;color:#555;max-width:600px;">A new way to interact with email for high-performing modern families. Connect your Gmail to surface only what matters‚Äîschool alerts, doctor updates, smart deals, and more.</p>
          
          <!-- Gmail Connection Status -->
          <div id="gmail-status" class="gmail-status">
            <div id="gmail-not-connected" class="gmail-not-connected">
              <button id="connect-gmail-btn" class="gmail-connect-btn">
                <i data-lucide="mail" style="width:1.2rem;height:1.2rem;margin-right:0.5rem;"></i>
                Connect Gmail
              </button>
              <p class="gmail-status-text">Connect your Gmail to start decoding emails</p>
            </div>
            <div id="gmail-connected" class="gmail-connected" style="display:none;">
              <div class="gmail-status-success">
                <i data-lucide="check-circle" style="width:1.2rem;height:1.2rem;color:#10b981;margin-right:0.5rem;"></i>
                <span>Gmail Connected</span>
              </div>
              <button id="process-emails-btn" class="process-emails-btn">
                <i data-lucide="refresh-cw" style="width:1.2rem;height:1.2rem;margin-right:0.5rem;"></i>
                Process Emails
              </button>
            </div>
          </div>

          <!-- Email Processing Status -->
          <div id="email-processing-status" class="email-processing-status" style="display:none;">
            <div class="processing-indicator">
              <i data-lucide="loader-2" class="spinning" style="width:1.2rem;height:1.2rem;margin-right:0.5rem;"></i>
              <span>Processing your emails...</span>
            </div>
          </div>

          <!-- Email Summary -->
          <div id="email-summary" class="email-summary" style="display:none;">
            <div class="summary-stats">
              <div class="stat-item">
                <span class="stat-number" id="total-emails">0</span>
                <span class="stat-label">Processed</span>
              </div>
              <div class="stat-item">
                <span class="stat-number" id="family-signals">0</span>
                <span class="stat-label">Family Signals</span>
              </div>
              <div class="stat-item">
                <span class="stat-number" id="smart-deals">0</span>
                <span class="stat-label">Smart Deals</span>
              </div>
              <div class="stat-item">
                <span class="stat-number" id="action-items">0</span>
                <span class="stat-label">Action Items</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Decoded Email Cards -->
        <div id="decoded-emails-container" class="decoded-emails-container" style="display:none;">
          <h3 style="margin:1.5rem 0 1rem;font-size:1.3rem;color:#1e293b;">Recent Decoded Emails</h3>
          <div id="decoded-emails-list" class="decoded-emails-list">
            <!-- Dynamic email cards will be inserted here -->
          </div>
        </div>

        <!-- Example Cards (shown when no emails processed) -->
        <div id="email-decoder-examples" class="email-decoder-examples">
          <div class="example-header">
            <h3 style="margin:1.5rem 0 1rem;font-size:1.3rem;color:#1e293b;">How it works</h3>
          </div>
          <div style="display:flex;gap:2rem;flex-wrap:wrap;">
            <!-- Example Family Signal Card -->
            <div class="family-signal-card example-card">
              <i data-lucide="school" class="signal-icon" style="width:2rem;height:2rem;color:#1e88e5;vertical-align:middle;"></i>
              <div>
                <strong>Family Signal</strong><br>
                Picture Day ‚Äì Oct 15 at 9 AM<br>
                <span style="color:#1565c0;">Location: Woods Academy | Action: Send in photo form</span><br>
                <button class="form-btn">Form attached</button>
              </div>
            </div>
            <!-- Example Smart Deal Card -->
            <div class="smart-deal-card example-card">
              <i data-lucide="shopping-cart" class="deal-icon" style="width:2rem;height:2rem;color:#b26a00;vertical-align:middle;"></i>
              <div>
                <strong>Smart Deal</strong><br>
                You've bought Honest Co. 4x this year<br>
                <span style="color:#b26a00;">Today: 15% off sitewide + free shipping</span><br>
                <button class="deal-btn">Reorder Diapers</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- This Week Summary -->
      <div id="this-week-module" class="home-module">
        <div class="module-header">
          <h2>üóìÔ∏è This Week</h2>
          <p>A summary of your calendar and key tasks.</p>
        </div>
        <div class="module-content">
          <div class="week-summary-placeholder">
            <p>Your weekly summary will appear here...</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Chat View -->
  <section id="chat-view" class="view">
    <div class="chat-wrapper">
      <div id="chat" class="chat-box"></div>
      <form id="chatForm" class="chat-form">
        <input id="input" type="text" placeholder="Type something..." autocomplete="off" />
        <button type="submit">Send</button>
      </form>
    </div>
  </section>

  <!-- Dashboard View -->
  <section id="dashboard-view" class="view">
    <h2>üìä The House View</h2>
    <div class="dashboard-grid">
      <div class="dashboard-card" id="structured-week-card">
        <h3>üìÖ This Week</h3>
        <div id="structured-schedule"></div>
        <h4>üß† Reminders</h4>
        <ul id="structured-reminders"></ul>
      </div>
      <div class="dashboard-card">
        <h3>Mental Load</h3>
        <ul></ul>
      </div>
      <div class="dashboard-card">
        <h3>Reframes</h3>
        <div class="reframe-list"></div>
      </div>
    </div>
    <div id="relief-protocol" class="relief-card">
      <div class="relief-header">
        <h2>üß† Relief Protocol</h2>
        <p class="subtle-label">Based on recent load patterns</p>
      </div>
      <div class="relief-section">
        <label>Summary</label>
        <p id="relief-summary">Loading...</p>
      </div>
      <div class="relief-section">
        <label>Offload </label>
        <p id="relief-offload">Loading...</p>
      </div>
      <div class="relief-section">
        <label>Reclaim </label>
        <p id="relief-reclaim">Loading...</p>
      </div>
      <div class="relief-section">
        <label>Reconnect </label>
        <p id="relief-reconnect">Loading...</p>
      </div>
      <div class="relief-section">
        <label>Pattern Interrupt </label>
        <p id="relief-interrupt">Loading...</p>
      </div>
      <div class="relief-section" id="reframe-block" style="display: none;">
        <label>Reframe </label>
        <p id="relief-reframe">Loading...</p>
      </div>
    </div>
  </section>

  <!-- Calendar View -->
  <section id="calendar-view" class="view">
    <div class="view-header">
      <h2><i data-lucide="calendar-days" style="width:1.2em;height:1.2em;vertical-align:-0.2em;margin-right:0.4em;"></i>My Calendar</h2>
      <button id="clear-events-btn" class="button-danger">Clear All Events</button>
    </div>
    <div id="calendar"></div>
  </section>

</main>
</div>

<!-- ‚úÖ Icons MUST be loaded before your app scripts -->
<script src="https://unpkg.com/lucide@latest"></script>

<!-- ‚úÖ FullCalendar CSS -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/main.min.css" rel="stylesheet" />

<!-- ‚úÖ FullCalendar Global Build ‚Äî works without import or modules -->
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.9/index.global.min.js"></script>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.10.0/firebase-auth-compat.js"></script>

<!-- ‚úÖ Your app scripts -->
<script src="layout.js" defer></script>
<script src="chat.js" defer></script>
<script src="/relief.js" defer></script>

<!-- ‚úÖ Bottom nav for mobile view -->
<div class="bottom-nav">
  <button data-view="home" onclick="activateView('home')">üè†</button>
  <button data-view="chat" onclick="activateView('chat')">üí¨</button>
  <button data-view="dashboard" onclick="activateView('dashboard')">üìä</button>
  <button data-view="calendar" onclick="activateView('calendar')">üìÖ</button>
</div>

<script src="/homebase.js" defer></script>
</body>
</html>



